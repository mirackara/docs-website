---
title: Magento monitoring integration
tags:
    - New Relic integrations
    - Magento
metaDescription: Monitor your Magento application.
---

import apmMagentoDashboardOverview from 'images/apm_screenshot-full_magento-dashboard-overview.png'

Our Magento integration monitors the performance of your Magento ecommerce application, helping you diagnose issues in your app's performance and respond by optimizing your code. Our Magento integration relies on our agents to collect and report your app data, and
you'll have access to a pre-built dashboard with important app metrics, like errors, application crashes, app launches, app installations, HTTP errors, and network failures.

<img
    title="Magento dashboard overview"
    alt="screenshot of Magento dashboard"
    src={apmMagentoDashboardOverview}
/>

<figcaption>
    After setting up our Magento integration, we give you a dashboard for your Magento app data.
</figcaption>

<Steps>
    <Step>
        ## (Optional) Install the infrastructure agent

        Our infrastructure agent monitors your host and reports metrics such as CPU usage, memory usage, storage usage, disk usage, and network traffic. 
        
        To install the agent, follow the steps in our [guided install](https://one.newrelic.com/launcher/nr1-core.explorer?pane=eyJuZXJkbGV0SWQiOiJucjEtY29yZS5saXN0aW5nIn0=&cards[0]=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsImFjdGl2ZUNvbXBvbmVudCI6IlZUU09FbnZpcm9ubWVudCIsInBhdGgiOiJndWlkZWQifQ==).
        
        If you need to install the agent in a different way, see [Install the infrastructure monitoring agent](/docs/infrastructure/install-infrastructure-agent/get-started/install-infrastructure-agent/).

        </Step>

    <Step>
        ## Install the PHP agent

        Our PHP agent reports application and browser-related metrics such as AJAX performance, error rate, duration, core web vitals, and throughput.
        
        To install the agent, follow the steps in our [guided install](https://one.newrelic.com/launcher/nr1-core.settings?pane=eyJuZXJkbGV0SWQiOiJ0dWNzb24ucGxnLWluc3RydW1lbnQtZXZlcnl0aGluZyJ9&cards[0]=eyJuZXJkbGV0SWQiOiJzZXR1cC1uZXJkbGV0cy5zZXR1cC1waHAtaW50ZWdyYXRpb24iLCJhY2NvdW50SWQiOjI2NDA0MDl9&platform[accountId]=1).
        
        If you need to install the agent in a different way, see [PHP agent installation overview](/docs/apm/agents/php-agent/installation/php-agent-installation-overview/).

        </Step>
    
    <Step>
        ## Install the MySQL integration

        Our MySQL integration monitors your databases and collects metrics such as database utilization and connections such as slowest queries and active connections by node.

        To install the integration:

            1. Go to **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > Add data.
            2. Search for and select "MySQL"
            3. Select an account and follow the guided install steps.

        If you need to install the agent in a different way, see [MySQL monitoring integration](/install/mysql/).

        </Step>
    
    <Step>
        ## Install the Apache integration

        Our Apache integrations collects network metrics like TCP connections, DNS lookup, HTTPS, SSL, and server and worker statuses.

        To install the integration, follow the steps in our [guided install](https://one.newrelic.com/launcher/nr1-core.explorer?pane=eyJuZXJkbGV0SWQiOiJucjEtY29yZS5saXN0aW5nIn0=&cards[0]=eyJuZXJkbGV0SWQiOiJucjEtaW5zdGFsbC1uZXdyZWxpYy5ucjEtaW5zdGFsbC1uZXdyZWxpYyIsInBhdGgiOiJvaGkiLCJyZWNpcGVOYW1lIjoiYXBhY2hlLW9wZW4tc291cmNlLWludGVncmF0aW9uIiwiYWN0aXZlQ29tcG9uZW50IjoiVlRTT0NvbW1hbmQiLCJhY3RpdmVFbnZpcm9ubWVudCI6ImFwYWNoZS1vcGVuLXNvdXJjZS1pbnRlZ3JhdGlvbiJ9).
        
        If you need to install the agent in a different way, see [Apache monitoring integration](/docs/infrastructure/host-integrations/host-integrations-list/apache-monitoring-integration).

        </Step>
    

    <Step>
        ## Install the Elasticsearch integration
        
        Our Elasticsearch integration collects metrics like cluster status and current shards. If you're using [Magento version 2.4 and higher](https://magentip.com/install-magento-2-4-x-on-ubuntu-with-elasticsearch/), you'll to install an ElasticSearch application and agent to monitor that application. 
        
        To install the integration:

        1. Go to **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > Add data.
        2. Search for and select "Elasticsearch"
        3. Select an account and follow the guided install steps.

        If you need to install the agent in a different way, see [Apache monitoring integration](/docs/infrastructure/host-integrations/host-integrations-list/elasticsearch/elasticsearch-integration).

        </Step>
    

    <Step>
        ## Create synthetic monitors

        Our synthetic monitoring feature uses synthetic monitors to test your app in different geolocations for things like availability, page load performance, and user flow.

        To create synthetic monitors, follow the steps in our [guided install](https://onenr.io/0EjOXrnxgQ6).

        </Step>
    

    <Step>
        ## Install the AWS Identity and Access Management (IAM) integration
        
        Our AWS IAM integration collects metrics such as certificates per account, groups per account, MFA devices per account, roles per account, and users per account.

        To install the integration:

        1. Go to **[one.newrelic.com](https://one.newrelic.com/all-capabilities)** and click the **Integrate your AWS account** card. 
        2. Select an account and follow the guided install steps.

        For more information on this integration, see [AWS IAM integration](/docs/infrastructure/amazon-integrations/aws-integrations-list/aws-iam-monitoring-integration)
        </Step>
    

    <Step>
        ## Install the Flex integration

        Our Flex integration allows you to capture business metrics through queries of your app database.

        To install the integration:

        1. Create an `nri-flex` configuration file:

            * Path to the configuration file: `/etc/newrelic-infra/integrations.d/`
            * Configuration file name: mysql-database-config.yml

        2. Add this `nri-flex` code snippet to the configuration file:

            ```
            # NOTE: 'database' is an experimental API at this time
            # ref: https://github.com/newrelic/nri-flex/blob/master/docs/experimental/db.md
            ---
            integrations:
            - name: nri-flex
                # interval: 30s
                config:
                name: MySQLDbFlex
                apis:
                    - database: mysql
                    # connection string for an rds mysql instance. Be sure to use the writer endpoint here.  /sys is the default database. newrelic:Password is the user:pass.
                    db_conn: newrelic:Root!123@tcp(localhost:3306)/magento2 
                    logging:
                        open: true
                    # custom_attributes: # applies to all queries
                    #   host: CustomMagentoMySQL # custom host name atribute
                    db_async: true # process queries async
                    db_queries:
                        - name: MySQLShowVars
                        run: SHOW VARIABLES;
                        custom_attributes: # can apply additional at a nested level
                            attype: show-vars
                            host: CustomMagentoMySQL
                        - name: MySQLShowStatus
                        run: SHOW STATUS LIKE 'Max%conn%';
                        custom_attributes: # can apply additional at a nested level
                            attype: used-conns
                            host: CustomMagentoMySQL
                        - name: MySQLCustomProcessList
                        run: SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST # grab all processes from MySQL
                        custom_attributes: # can apply additional at a nested level
                            attype: info-schema-query
                            host: CustomMagentoMySQL
                        - name: MYSQLSalesOrderDetails
                        run: SELECT grand_total, shipping_amount, subtotal, total_paid, discount_amount, store_currency_code, created_at, updated_at, customer_is_guest, tax_amount, customer_id, status, entity_id AS 'order_id' FROM sales_order;
                        - name: MySQLSalesOrderCumulative
                        run: SELECT AVG(grand_total) AS 'average_grand_total', SUM(grand_total) AS 'grand_total_sum', SUM(total_item_count) AS 'total_order_item_count' FROM sales_order;
                        custom_attributes: # can apply additional at a nested level
                            attype: blocking-query
                            host: CustomMagentoMySQL
                        - name: MySQLSalesOrderByStatus
                        run: SELECT status AS 'order_status', COUNT(increment_id) AS 'total_orders', (SUM(grand_total)) AS 'total_billed_amount_by_status' FROM sales_order GROUP BY status;
                        - name: MYSQLSalesOrderByCustomerGroup
                        run: SELECT SUM(salesOrder.grand_total) AS 'grand_total_sum_of_all_orders', AVG(salesOrder.grand_total) AS 'grand_total_average_of_all_orders', customerGroup.customer_group_code AS 'customer_group_code' FROM `sales_order` salesOrder JOIN `customer_group` customerGroup ON salesOrder.customer_group_id = customerGroup.customer_group_id GROUP BY salesOrder.customer_group_id;
                        - name: MYSQLSalesOrderByProduct
                        run: SELECT items.order_id AS 'Order ID', items.created_at AS 'Order Created Date', orders.status AS 'Order Status', items.name AS 'productName', items.sku AS ProductSearchcode, orders.total_item_count AS 'Order Quantity', orders.grand_total AS 'Grand Total' FROM sales_order AS orders JOIN sales_order_item AS items ON items.order_id = orders.entity_id;
                        - name: MYSQLSalesOrderByCategory
                        run: SELECT items.name AS Category, AVG(orders.grand_total) AS 'average_order_total'  FROM sales_order AS orders JOIN sales_order_item AS items ON items.order_id = orders.entity_id GROUP BY items.name;
                        - name: MYSQLSalesOrderByRegion
                        run: SELECT soa.country_id, soa.region_id, dcrn.name 'Region Name', so.entity_id AS 'Order ID', so.grand_total FROM sales_order_address soa JOIN directory_country_region_name dcrn JOIN sales_order so WHERE soa.region_id = dcrn.region_id AND so.entity_id = soa.parent_id;
                        - name: MYSQLSalesOrderByCustomer
                        run: SELECT so.customer_id, ce.email, AVG(so.grand_total) AS 'average_grand_total' FROM sales_order so JOIN customer_entity ce ON so.customer_id = ce.entity_id GROUP BY so.customer_id;
                        - name: MYSQLMagentoDetails
                        run: SELECT query_text, num_results FROM `search_query`;
                        - name: MySQLSalesOrderPayment
                        run: SELECT amount_ordered, shipping_amount, method, additional_information FROM sales_order_payment;
                        custom_attributes: # can apply additional at a nested level
                            attype: blocking-query
                            host: CustomMagentoMySQL
                        - name: MySQLSalesOrderPaymentCount
                        run: SELECT count(*) as CountOfOrderByMethod, method as PaymentMethodType FROM `sales_order_payment` group by method;
                        custom_attributes: # can apply additional at a nested level
                            attype: blocking-query
                            host: CustomMagentoMySQL
                        - name: MySQLCustomerEntity
                        run: SELECT email, created_at, is_active FROM customer_entity;
                        - name: MYSQLAbandonedCarts
                        run: SELECT customer_email, items_count AS 'Products', items_qty AS 'Quantity', subtotal, remote_ip, reserved_order_id FROM `quote` WHERE customer_email IS NOT NULL AND reserved_order_id IS NULL AND subtotal != 0.0000;
                        - name: MYSQLCustomerEntityRegisteredUsers
                        run: SELECT count(*) AS 'Registered Accounts' FROM `customer_entity`;
                        - name: MYSQLUnregisteredCustomers
                        run: SELECT customer_email FROM sales_order WHERE customer_is_guest = 1 GROUP BY customer_email;
                        - name: MYSQLSalesOrderByUnregisteredCustomers2
                        run: SELECT COUNT(entity_id) AS 'Total Order Ids', SUM(grand_total) AS 'Grand Total Sum' FROM sales_order WHERE customer_is_guest = 1;
                        - name: MYSQLCustomerEntityActiveUsers
                        run: SELECT count(is_active) AS 'Active Users' FROM `customer_entity` WHERE is_active = 1;
                        - name: MYSQLReturningCustomers
                        run: WITH ctel1 AS (SELECT COUNT(entity_id) AS 'numberOfOrders', customer_email AS 'customerEmail' FROM sales_order GROUP BY customer_email) SELECT count(*) AS 'returningCustomers' FROM ctel1 WHERE numberOfOrders > 1;
                        - name: MYSQLNewCustomers
                        run: SELECT COUNT(DISTINCT email) AS 'newCustomers' FROM customer_entity WHERE MONTH(created_at) >= MONTH(CURRENT_DATE() - INTERVAL 1 MONTH);
                        - name: MYSQLLoginsPerDay
                        run: SELECT DATE(last_visit_at) as 'Date', count(*) as 'Total Logins', count(DISTINCT customer_id) AS 'Number of Customers' FROM `customer_visitor` GROUP BY customer_id, DATE(last_visit_at);
                        - name: MYSQLBestSellersDaily
                        run: SELECT SUM(qty_ordered) as 'QuantityOrdered', product_name FROM sales_bestsellers_aggregated_daily GROUP BY product_id, product_name ORDER BY QuantityOrdered DESC;
                        - name: MYSQLRevenuePerMonthAndYear
                        run: SELECT SUM(grand_total) AS 'TotalRevenue', AVG(grand_total) AS 'AverageRevenue', YEAR(created_at) AS 'Year', MONTH(created_at) AS 'Month' FROM sales_order WHERE status = 'complete' GROUP BY YEAR(created_at), MONTH(created_at);
                        - name: MYSQLMostViewedProductsDaily
                        run: SELECT SUM(views_num) as 'viewCount', product_name FROM report_viewed_product_aggregated_daily GROUP BY product_name ORDER BY viewCount DESC;
                        - name: MYSQLConversionRate
                        run: WITH cte1 AS (SELECT soi.product_id AS 'SalesProductId', soi.name AS 'ProductName', COUNT(soi.order_id) AS 'totalOrders' FROM `sales_order_item` soi group by soi.product_id, soi.name), cte2 AS (SELECT viewed.product_id AS 'productId', COUNT(viewed.product_id) AS 'totalViews' FROM `report_viewed_product_index` viewed group by viewed.product_id) SELECT SalesProductId as 'productID', ProductName, totalViews,totalOrders,totalOrders/totalViews *100 as 'conversionRateInPercent' FROM cte1 JOIN cte2 WHERE cte1.SalesProductId = cte2.ProductId;
                        - name: MYSQLTopTenSalesOrdersByValue
                        run: SELECT entity_id AS 'orderId', total_item_count AS 'orderQuantity', created_at AS 'createdDate', grand_total AS 'grandTotal' FROM sales_order ORDER BY grand_total DESC LIMIT 10;
                        - name: MYSQLOrdersAverage
                        run: SELECT AVG(order_count) AS 'AverageNumberOfOrders', Year AS 'Year' FROM (SELECT YEAR(created_at) AS 'Year', COUNT(DISTINCT order_id) AS order_count FROM sales_order_item GROUP BY MONTH(created_at), YEAR(created_at)) subquery GROUP BY Year;
                        - name: MYSQLProductsTotal
                        run: SELECT count(*) AS 'Total Products' FROM catalog_product_entity_varchar WHERE attribute_id = 73;
                        custom_attributes: # can apply additional at a nested level
                            attype: blocking-query
                            host: CustomMagentoMySQL


                ```

  
        3. Restart the infrastructure agent

        To start sending all the Flex query results to [one.newrelic.com](one.newrelic.com), you'll need to restart the infrastructure agent. Follow the steps on [Start, stop, and restart the infrastructure agent](/docs/infrastructure/install-infrastructure-agent/manage-your-agent/start-stop-restart-infrastructure-agent/).

        Once you've got Flex queries in New Relic, you can use a NRQL query to view data and create dashboards and charts based on queries. 
        
        For example, query the following to view total registered customers on your magento platform:

        ```
        SELECT LATEST(`Registered Accounts`) AS ‘Registered Accounts’ FROM MYSQLCustomerEntityRegisteredUsers
        ```

    </Step>

<Step>
    ## View your app data

    To instrument the Magento quickstart and to see metrics and alerts, follow the steps on the [Magento Business Insights quickstart page](https://newrelic.com/instant-observability/magento).

    To view your Magento app data, add our pre-built dashboard named “Magento Business Insights” to your account: 
        1. Go to **[one.newrelic.com](https://one.newrelic.com/all-capabilities) > Dashboards** and search for "Magento". You should see our pre-build dashboard named “Magento Business Insights”. Click on it to add it to your account.
        
        </Step>

</Steps>